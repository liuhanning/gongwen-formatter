# 格式模式说明

## 📌 概述

公文格式化工具现已支持**两种格式模式**，以满足不同场景的需求：

1. **GB/T 9704标准模式**（默认）
2. **政府交付版模式**

## 🔍 两种模式的区别

### 核心差异：标题缩进方式

| 标题级别 | GB/T 9704标准模式 | 政府交付版模式 |
|---------|------------------|---------------|
| 一级标题 | 居中，无缩进 | 居中，无缩进 |
| 二级标题 | 左对齐，**左缩进2字符** | 左对齐，**首行缩进2字符** |
| 三级标题 | 左对齐，**左缩进2字符** | 左对齐，**首行缩进2字符** |
| 四级标题 | 左对齐，**左缩进2字符** | 左对齐，**首行缩进2字符** |
| 五级标题 | 左对齐，**左缩进2字符** | 左对齐，**首行缩进2字符** |
| 正文 | 首行缩进2字符 | 首行缩进2字符 |

### 视觉效果对比

#### GB/T 9704标准模式（左缩进）
```
一级标题（居中）

  一、二级标题
正文内容正文内容正文内容...

  （一）三级标题
正文内容正文内容正文内容...

  1．四级标题
正文内容正文内容正文内容...
```

#### 政府交付版模式（首行缩进）
```
一级标题（居中）

一、二级标题
  正文内容正文内容正文内容...

（一）三级标题
  正文内容正文内容正文内容...

1．四级标题
  正文内容正文内容正文内容...
```

## 📋 详细规格对比

### 共同点（两种模式相同）

✅ 页面设置
- A4纸张（210mm × 297mm）
- 上边距：3.7cm，下边距：3.5cm
- 左边距：2.8cm，右边距：2.6cm
- 页眉页脚：1.8cm

✅ 字体要求
- 一级标题：方正小标宋简体 二号
- 二级标题：黑体 三号
- 三级标题：楷体_GB2312 三号
- 四级标题：仿宋_GB2312 三号
- 正文：仿宋_GB2312 三号

✅ 行距要求
- 一、二、三级标题：固定值30磅
- 四、五级标题：固定值28磅
- 正文：固定值28磅

✅ 序号规则
- 二级：一、二、三、
- 三级：（一）（二）（三）
- 四级：1．2．3．（全角点）
- 五级：（1）（2）（3）
- 六级：①②③

✅ 表格和图片格式
- 表题：黑体小四，不加粗，居中
- 表头：黑体小四
- 表格内容：仿宋_GB2312小四
- 插图标题：黑体小四，图下方居中

### 差异点

| 项目 | GB/T 9704标准模式 | 政府交付版模式 |
|------|------------------|---------------|
| 二级标题缩进 | 左缩进2字符 | 首行缩进2字符 |
| 三级标题缩进 | 左缩进2字符 | 首行缩进2字符 |
| 四级标题缩进 | 左缩进2字符 | 首行缩进2字符 |
| 五级标题缩进 | 左缩进2字符 | 首行缩进2字符 |
| 文档网格对齐 | 不要求 | 要求对齐到网格 |

## 🎯 使用场景建议

### GB/T 9704标准模式
**适用于：**
- 党政机关公文
- 正式行政文件
- 传统公文格式要求的文档
- 需要严格符合GB/T 9704-2012标准的场景

**特点：**
- 标题整体左移，视觉上更加突出
- 符合传统公文排版习惯
- 标题与正文有明显的缩进差异

### 政府交付版模式
**适用于：**
- 政府部门交付的咨询报告
- 研究报告、分析报告
- 项目文档、技术文档
- 需要符合政府交付标准的文档

**特点：**
- 标题序号顶格，内容首行缩进
- 视觉上更加简洁统一
- 符合现代文档排版趋势

## 💻 如何选择格式模式

### 1. Web界面
在上传文档区域，选择对应的格式模式单选按钮：
- **GB/T 9704标准** - 标题左缩进2字符
- **政府交付版** - 标题首行缩进2字符

### 2. Python命令行
```bash
# 使用GB/T 9704标准模式（默认）
python gongwen_formatter.py input.docx output.docx

# 使用政府交付版模式
python gongwen_formatter.py input.docx output.docx --government
# 或使用简写
python gongwen_formatter.py input.docx -g
```

### 3. Python API
```python
from gongwen_formatter import GongwenFormatter, FORMAT_MODE_STANDARD, FORMAT_MODE_GOVERNMENT

# GB/T 9704标准模式
formatter = GongwenFormatter(format_mode=FORMAT_MODE_STANDARD)

# 政府交付版模式
formatter = GongwenFormatter(format_mode=FORMAT_MODE_GOVERNMENT)
```

## 📚 参考标准

### GB/T 9704标准模式
- **标准名称**：GB/T 9704-2012 党政机关公文格式
- **发布单位**：国家质量监督检验检疫总局、国家标准化管理委员会
- **实施日期**：2012年7月1日

### 政府交付版模式
- **参考文档**：政府部门格式标准.txt
- **适用范围**：政府交付咨询报告、研究报告等
- **核心要求**：标题首行缩进、文档网格对齐

## ❓ 常见问题

### Q1: 两种模式可以互相转换吗？
A: 可以。只需重新运行格式化工具并选择不同的模式即可。

### Q2: 如何判断文档使用的是哪种模式？
A: 查看二级标题的缩进方式：
- 如果整个标题左移2字符 → GB/T 9704标准模式
- 如果只有首行缩进2字符 → 政府交付版模式

### Q3: 哪种模式更好？
A: 没有绝对的好坏，取决于具体需求：
- 如果是正式公文，建议使用**GB/T 9704标准模式**
- 如果是政府交付报告，建议使用**政府交付版模式**

### Q4: 可以自定义缩进方式吗？
A: 目前支持这两种标准模式。如有特殊需求，可以修改源代码中的样式定义。

## 🔄 版本历史

### v1.1 (2026-02-08)
- ✅ 新增政府交付版格式模式
- ✅ 支持命令行参数选择模式
- ✅ Web界面添加模式选择器
- ✅ 更新文档和说明

### v1.0 (2026-02-04)
- ✅ 初始版本
- ✅ 支持GB/T 9704标准模式

---

**文档版本**: v1.0
**更新日期**: 2026-02-08
**作者**: Antigravity AI
