# 🔄 VBA宏文件更新指南

## ⚠️ 重要提示

如果您之前已经导入了VBA宏，请按照以下步骤更新到最新版本。

## 📋 更新内容 (v1.1)

### ✨ 新增功能
- ✅ 格式模式选择（GB/T 9704标准 / 政府交付版）
- ✅ 模式选择对话框
- ✅ 动态标题缩进设置

### 🐛 Bug修复
- ✅ 修复特殊字符编码问题（✓ → √）

## 🔧 更新步骤

### 对于Word用户

#### 步骤1：删除旧模块
1. 打开Word
2. 按 `Alt + F11` 打开VBA编辑器
3. 在左侧项目窗口中找到 `GongwenFormatter` 模块
4. 右键点击 → 选择"移除 GongwenFormatter"
5. 选择"否"（不导出）

#### 步骤2：导入新模块
1. 在VBA编辑器中：文件 → 导入文件
2. 选择 `GongwenFormatter.bas`
3. 点击"打开"

#### 步骤3：验证
1. 按 `Alt + F8` 打开宏对话框
2. 选择 `FormatGongwen`
3. 点击"运行"
4. 应该看到格式模式选择对话框

### 对于WPS用户

#### 步骤1：删除旧模块
1. 打开WPS文字
2. 按 `Alt + F11` 打开VBA编辑器
3. 在左侧项目窗口中找到 `GongwenFormatter` 模块
4. 右键点击 → 选择"移除"

#### 步骤2：导入新模块
1. 在VBA编辑器中：文件 → 导入文件
2. 选择 `GongwenFormatter_WPS.bas`
3. 点击"打开"

#### 步骤3：验证
1. 按 `Alt + F8` 打开宏对话框
2. 选择 `FormatGongwen`
3. 点击"运行"
4. 应该看到格式模式选择对话框

## 🎯 新功能使用

### 格式模式选择对话框

运行宏后会弹出：

```
┌─────────────────────────────────────┐
│        选择格式模式                  │
├─────────────────────────────────────┤
│ 请选择格式模式：                     │
│                                      │
│ 【是】= GB/T 9704标准模式            │
│       （标题左缩进2字符）             │
│                                      │
│ 【否】= 政府交付版模式               │
│       （标题首行缩进2字符）           │
│                                      │
│ 【取消】= 取消操作                   │
│                                      │
│         [是]  [否]  [取消]           │
└─────────────────────────────────────┘
```

### 完成消息

格式化完成后会显示：

```
公文格式化完成！

格式模式：政府交付版（标题首行缩进）

已完成以下操作：
√ 页面设置（A4纸、标准边距）
√ 段落格式化（字体、行距、缩进）
√ 添加页码（页脚居中）
√ 符号替换（逗号、括号、冒号、引号）

提示：按 Ctrl+Z 可撤销所有更改
```

## ❓ 常见问题

### Q1: 更新后找不到宏？
**A**: 确保导入的是正确的文件：
- Word用户 → `GongwenFormatter.bas`
- WPS用户 → `GongwenFormatter_WPS.bas`

### Q2: 对话框显示乱码？
**A**: 这是编码问题，请确保使用最新版本的 .bas 文件（已修复）。

### Q3: 可以保留旧版本吗？
**A**: 可以，但建议更新到新版本以获得格式模式选择功能。

### Q4: 更新会影响现有文档吗？
**A**: 不会。更新只影响宏代码，不会修改已有文档。

## 📚 相关文档

- **VBA宏版本更新说明.md** - 详细更新说明
- **VBA编码问题修复.md** - 编码问题修复说明
- **README.md** - 完整使用文档

## 🆘 需要帮助？

如果更新过程中遇到问题：
1. 检查是否使用了正确的 .bas 文件
2. 确认VBA编辑器中没有编译错误
3. 尝试重启Word/WPS后重新导入

---

**版本**: v1.1
**更新日期**: 2026-02-08
**状态**: ✅ 推荐更新
