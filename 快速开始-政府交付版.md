# 快速开始指南 - 政府交付版模式

## 🚀 立即使用

### 方式一：Web界面（最简单）

1. **启动服务器**
   ```bash
   python web_server.py
   ```

2. **打开浏览器**
   访问 http://localhost:5000

3. **选择格式模式**
   - 在"格式模式"区域选择：
     - ⭕ GB/T 9704标准（标题左缩进2字符）
     - ⭕ 政府交付版（标题首行缩进2字符）✨ 新增

4. **上传并格式化**
   - 拖拽或点击上传 .docx 文件
   - 点击"格式化文档"按钮
   - 自动下载格式化后的文档

### 方式二：Python命令行（最快速）

```bash
# 标准模式（默认）
python gongwen_formatter.py input.docx output.docx

# 政府交付版模式 ✨ 新增
python gongwen_formatter.py input.docx output.docx --government
# 或使用简写
python gongwen_formatter.py input.docx output.docx -g

# 生成示例文档
python gongwen_formatter.py              # 标准模式
python gongwen_formatter.py --government # 政府交付版
```

### 方式三：Python API（最灵活）

```python
from gongwen_formatter import (
    GongwenFormatter,
    FORMAT_MODE_STANDARD,      # 标准模式
    FORMAT_MODE_GOVERNMENT     # 政府交付版 ✨ 新增
)

# 创建格式化器
formatter = GongwenFormatter(
    format_mode=FORMAT_MODE_GOVERNMENT  # 选择政府交付版
)

# 添加内容
formatter.add_heading('文档标题', 1)
formatter.add_heading('一、主要内容', 2)
formatter.add_body_paragraph('这是正文内容...')

# 保存
formatter.save('output.docx')
```

## 📊 两种模式对比

### 视觉效果

#### 标准模式（左缩进）
```
        一级标题（居中）

  一、二级标题
  正文内容首行缩进...

  （一）三级标题
  正文内容首行缩进...
```

#### 政府交付版（首行缩进）✨
```
        一级标题（居中）

一、二级标题
  正文内容首行缩进...

（一）三级标题
  正文内容首行缩进...
```

### 适用场景

| 场景 | 推荐模式 |
|------|---------|
| 党政机关公文 | GB/T 9704标准 |
| 正式行政文件 | GB/T 9704标准 |
| 政府交付报告 | 政府交付版 ✨ |
| 咨询研究报告 | 政府交付版 ✨ |
| 项目技术文档 | 政府交付版 ✨ |

## ⚡ 常用命令

```bash
# 查看帮助
python gongwen_formatter.py --help

# 标准模式格式化
python gongwen_formatter.py report.docx

# 政府交付版格式化
python gongwen_formatter.py report.docx -g

# 生成两种模式的示例对比
python gongwen_formatter.py                    # 生成 demo_gongwen.docx（标准）
python gongwen_formatter.py --government       # 生成 demo_gongwen.docx（政府版）
```

## 🎯 快速决策

**如果你不确定用哪种模式，问自己：**

1. 这是正式公文吗？
   - 是 → 使用 **GB/T 9704标准模式**
   - 否 → 继续下一题

2. 这是交付给政府部门的报告吗？
   - 是 → 使用 **政府交付版模式** ✨
   - 否 → 使用 **GB/T 9704标准模式**

## 📝 示例代码

### 完整示例：创建政府交付版报告

```python
from gongwen_formatter import GongwenFormatter, FORMAT_MODE_GOVERNMENT

# 创建格式化器（政府交付版）
formatter = GongwenFormatter(format_mode=FORMAT_MODE_GOVERNMENT)

# 设置页眉页码
formatter.add_header('XX市交通规划咨询报告')
formatter.add_page_number()

# 添加标题和内容
formatter.add_heading('XX市交通规划咨询报告', 1)

formatter.add_heading('一、项目背景', 2)
formatter.add_body_paragraph('本项目旨在...')

formatter.add_heading('（一）研究目标', 3)
formatter.add_body_paragraph('主要研究目标包括...')

formatter.add_heading('1．总体目标', 4)
formatter.add_body_paragraph('总体目标是...')

# 添加表格
table_data = [
    ['序号', '指标名称', '目标值'],
    ['1', '道路通行率', '≥85%'],
    ['2', '公交覆盖率', '≥90%']
]
formatter.add_table('表1 主要指标体系', 3, 3, table_data)

# 保存
formatter.save('交通规划报告.docx')
print('✅ 报告生成完成！')
```

## 🔄 模式转换

如果需要将现有文档从一种模式转换为另一种：

```bash
# 标准模式 → 政府交付版
python gongwen_formatter.py old_standard.docx new_government.docx -g

# 政府交付版 → 标准模式
python gongwen_formatter.py old_government.docx new_standard.docx
```

## 💡 提示

1. **首次使用**：建议先生成示例文档查看效果
   ```bash
   python gongwen_formatter.py --government
   ```

2. **批量处理**：可以编写简单脚本批量转换
   ```python
   import os
   from gongwen_formatter import format_existing_document, FORMAT_MODE_GOVERNMENT

   for file in os.listdir('.'):
       if file.endswith('.docx'):
           format_existing_document(file, f'formatted_{file}', FORMAT_MODE_GOVERNMENT)
   ```

3. **Web界面**：适合不熟悉命令行的用户，界面直观易用

## 📞 需要帮助？

- 查看详细文档：`README.md`
- 格式对比说明：`格式模式说明.md`
- 实施总结：`政府交付版实施总结.md`

---

**版本**: v1.1
**更新**: 2026-02-08
**新功能**: ✨ 政府交付版格式模式
